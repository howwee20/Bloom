<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Bloom Console</title>
    <link rel="stylesheet" href="/console/styles.css" />
  </head>
  <body>
    <div class="console">
      <header class="console__header">
        <div>
          <p class="console__eyebrow">Bloom Console</p>
          <h1>Banking you can talk to.</h1>
          <p class="console__subhead">Reference client for the Bloom Kernel. Ask. Verify. Approve. Execute. Receipt.</p>
        </div>
        <div class="status" id="statusBadge">Disconnected</div>
      </header>

      <section class="card" id="sessionPanel">
        <div class="card__header">
          <h2>Unlock Console</h2>
          <p>Local session auth. No API keys in your browser.</p>
        </div>
        <div class="grid">
          <label class="field">
            <span>Console password</span>
            <input
              id="passwordInput"
              type="password"
              placeholder="Set CONSOLE_PASSWORD or leave blank on localhost"
              autocomplete="current-password"
            />
          </label>
          <label class="field" id="bootstrapTokenWrap" hidden>
            <span>Bootstrap code</span>
            <input id="bootstrapTokenInput" placeholder="Operator-provided code" autocomplete="off" />
          </label>
        </div>
        <div class="actions">
          <button class="btn btn--primary" id="loginButton">Enter Console</button>
        </div>
        <p class="error" id="sessionError"></p>
        <p class="hint" id="sessionHint">
          First run creates a single Bloom account. Set <code>CONSOLE_BOOTSTRAP_TOKEN</code> to require a code.
        </p>
      </section>

      <section class="console__main" id="consoleMain" hidden>
        <div class="console__grid">
          <div class="chat card">
            <div class="card__header">
              <h2>Talk to Bloom</h2>
              <p>Ask about balance or propose a transfer. Bloom will ask for approval before execution.</p>
            </div>
            <div class="chat__messages" id="chatMessages"></div>
            <form class="chat__composer" id="chatForm">
              <input id="chatInput" placeholder="Ask: &ldquo;How much do I have?&rdquo;" autocomplete="off" />
              <button class="btn btn--danger" id="stopButton" type="button">Stop</button>
              <button class="btn btn--primary" id="sendButton" type="submit">Send</button>
            </form>
            <div class="chat__pending">
              <div class="pending__header">
                <h3>Approvals</h3>
                <p>Bloom never executes without your explicit approval.</p>
              </div>
              <div id="pendingQuotes"></div>
            </div>
          </div>

          <div class="sidebar">
            <div class="card">
              <div class="card__header card__header--row">
                <div>
                  <h2>Account</h2>
                  <p id="accountMeta">Waiting for connection...</p>
                </div>
                <button class="btn btn--ghost btn--small" id="logoutButton" type="button">Sign out</button>
              </div>
              <div class="stat">
                <span>Available</span>
                <strong id="availableValue">&mdash;</strong>
              </div>
              <div class="stat">
                <span>Confirmed</span>
                <strong id="confirmedValue">&mdash;</strong>
              </div>
              <div class="stat">
                <span>Reserved</span>
                <strong id="reservedValue">&mdash;</strong>
              </div>
              <div class="divider"></div>
              <div class="field">
                <span>Address</span>
                <div class="inline">
                  <input id="walletAddress" readonly value="&mdash;" />
                  <button class="btn btn--ghost" id="copyAddress" type="button">Copy</button>
                </div>
              </div>
              <p class="hint" id="fundingHint">Add funds by sending USDC to this address.</p>
              <button class="btn btn--danger-outline" id="freezeButton" type="button">Freeze Account</button>
            </div>

            <div class="card">
              <div class="card__header">
                <h2>Receipts</h2>
                <p>Every action is recorded. This is the source of truth.</p>
              </div>
              <div class="receipt" id="receiptsList"></div>
            </div>
          </div>
        </div>
      </section>
    </div>

    <div class="modal" id="stepUpModal" hidden>
      <div class="modal__content">
        <h3>Approve Spend</h3>
        <p>Step-up required. Use the code below to approve this spend.</p>
        <div class="step-up__code" id="stepUpCode">&mdash;</div>
        <div class="actions">
          <button class="btn" id="stepUpCancel">Cancel</button>
          <button class="btn btn--primary" id="stepUpApprove">Approve</button>
        </div>
        <p class="hint" id="stepUpStatus"></p>
      </div>
    </div>

    <script src="/console/app.js"></script>
  </body>
</html>

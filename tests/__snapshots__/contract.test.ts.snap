// Vitest Snapshot v1, https://vitest.dev/guide/snapshot.html

exports[`Kernel contract snapshots > matches summary/timeline/receipt outputs > receipt 1`] = `
{
  "event": {
    "event_id": "evt_00000000-0000-0000-0000-000000000010",
    "payload": {
      "agent_id": "agent_contract",
      "auth_id": "A2",
      "facts_snapshot": {
        "buffer_cents": 0,
        "confirmed_balance_cents": 100000,
        "policy_caps": {
          "policy_spendable_cents": 50000,
        },
        "reserves": {
          "reserved_holds_cents": 0,
          "reserved_outgoing_cents": 0,
        },
      },
      "hold_amount_cents": 2000,
      "reason": "voided",
      "released_at": 1735689640,
    },
    "type": "card_released",
  },
  "facts_snapshot": {
    "buffer_cents": 0,
    "confirmed_balance_cents": 100000,
    "policy_caps": {
      "policy_spendable_cents": 50000,
    },
    "reserves": {
      "reserved_holds_cents": 0,
      "reserved_outgoing_cents": 0,
    },
  },
  "receipt": {
    "agentId": "agent_contract",
    "createdAt": 1735689640,
    "eventId": "evt_00000000-0000-0000-0000-000000000010",
    "externalRef": "A2",
    "occurredAt": 1735689640,
    "receiptId": "rcpt_00000000-0000-0000-0000-000000000011",
    "source": "policy",
    "userId": "user_contract",
    "whatHappened": "Card hold released.",
    "whatHappensNext": "Hold released from reserves.",
    "whyChanged": "card_released",
  },
}
`;

exports[`Kernel contract snapshots > matches summary/timeline/receipt outputs > summary 1`] = `
{
  "confirmed_balance_cents": 0,
  "effective_spend_power_cents": 50000,
  "last_receipts": [
    {
      "agentId": "agent_contract",
      "createdAt": 1735689640,
      "eventId": "evt_00000000-0000-0000-0000-000000000010",
      "externalRef": "A2",
      "occurredAt": 1735689640,
      "receiptId": "rcpt_00000000-0000-0000-0000-000000000011",
      "source": "policy",
      "userId": "user_contract",
      "whatHappened": "Card hold released.",
      "whatHappensNext": "Hold released from reserves.",
      "whyChanged": "card_released",
    },
    {
      "agentId": "agent_contract",
      "createdAt": 1735689630,
      "eventId": "evt_00000000-0000-0000-0000-000000000008",
      "externalRef": "A1",
      "occurredAt": 1735689630,
      "receiptId": "rcpt_00000000-0000-0000-0000-000000000009",
      "source": "policy",
      "userId": "user_contract",
      "whatHappened": "Card hold settled.",
      "whatHappensNext": "Hold released from reserves.",
      "whyChanged": "card_settled",
    },
    {
      "agentId": "agent_contract",
      "createdAt": 1735689620,
      "eventId": "evt_00000000-0000-0000-0000-000000000006",
      "externalRef": "A2",
      "occurredAt": 1735689620,
      "receiptId": "rcpt_00000000-0000-0000-0000-000000000007",
      "source": "policy",
      "userId": "user_contract",
      "whatHappened": "Card auth observed in shadow mode.",
      "whatHappensNext": "Hold recorded; shadow decision logged.",
      "whyChanged": "shadow_would_approve",
    },
    {
      "agentId": "agent_contract",
      "createdAt": 1735689610,
      "eventId": "evt_00000000-0000-0000-0000-000000000004",
      "externalRef": "A1",
      "occurredAt": 1735689610,
      "receiptId": "rcpt_00000000-0000-0000-0000-000000000005",
      "source": "policy",
      "userId": "user_contract",
      "whatHappened": "Card auth observed in shadow mode.",
      "whatHappensNext": "Hold recorded; shadow decision logged.",
      "whyChanged": "shadow_would_approve",
    },
    {
      "agentId": "agent_contract",
      "createdAt": 1735689600,
      "eventId": "evt_00000000-0000-0000-0000-000000000002",
      "externalRef": null,
      "occurredAt": 1735689600,
      "receiptId": "rcpt_00000000-0000-0000-0000-000000000003",
      "source": "policy",
      "userId": "user_contract",
      "whatHappened": "Agent created.",
      "whatHappensNext": "Agent can request quotes.",
      "whyChanged": "kernel.agent_created",
    },
  ],
  "reserved_outgoing_cents": 0,
  "total_spent_cents": 0,
}
`;

exports[`Kernel contract snapshots > matches summary/timeline/receipt outputs > timeline 1`] = `
{
  "timeline": [
    {
      "id": "evt_00000000-0000-0000-0000-000000000010",
      "kind": "event",
      "payload": {
        "agent_id": "agent_contract",
        "auth_id": "A2",
        "facts_snapshot": {
          "buffer_cents": 0,
          "confirmed_balance_cents": 100000,
          "policy_caps": {
            "policy_spendable_cents": 50000,
          },
          "reserves": {
            "reserved_holds_cents": 0,
            "reserved_outgoing_cents": 0,
          },
        },
        "hold_amount_cents": 2000,
        "reason": "voided",
        "released_at": 1735689640,
      },
      "ts": 1735689640,
      "type": "card_released",
    },
    {
      "event_id": "evt_00000000-0000-0000-0000-000000000010",
      "external_ref": "A2",
      "id": "rcpt_00000000-0000-0000-0000-000000000011",
      "kind": "receipt",
      "ts": 1735689640,
      "type": "policy",
      "what_happened": "Card hold released.",
      "what_happens_next": "Hold released from reserves.",
      "why_changed": "card_released",
    },
    {
      "id": "evt_00000000-0000-0000-0000-000000000008",
      "kind": "event",
      "payload": {
        "agent_id": "agent_contract",
        "auth_id": "A1",
        "facts_snapshot": {
          "buffer_cents": 0,
          "confirmed_balance_cents": 100000,
          "policy_caps": {
            "policy_spendable_cents": 50000,
          },
          "reserves": {
            "reserved_holds_cents": 2000,
            "reserved_outgoing_cents": 0,
          },
        },
        "hold_amount_cents": 1500,
        "metadata": null,
        "settled_amount_cents": 1450,
        "settled_at": 1735689630,
      },
      "ts": 1735689630,
      "type": "card_settled",
    },
    {
      "event_id": "evt_00000000-0000-0000-0000-000000000008",
      "external_ref": "A1",
      "id": "rcpt_00000000-0000-0000-0000-000000000009",
      "kind": "receipt",
      "ts": 1735689630,
      "type": "policy",
      "what_happened": "Card hold settled.",
      "what_happens_next": "Hold released from reserves.",
      "why_changed": "card_settled",
    },
    {
      "id": "evt_00000000-0000-0000-0000-000000000006",
      "kind": "event",
      "payload": {
        "agent_id": "agent_contract",
        "amount_cents": 2000,
        "auth_id": "A2",
        "auth_status": "dev_unsigned",
        "card_id": "card_contract",
        "currency": "USD",
        "facts_snapshot": {
          "buffer_cents": 0,
          "confirmed_balance_cents": 100000,
          "policy_caps": {
            "daily_limit_cents": 50000,
            "daily_remaining_cents": 50000,
          },
          "reserves": {
            "reserved_holds_cents": 1500,
            "reserved_outgoing_cents": 0,
          },
        },
        "mcc": "5812",
        "merchant": "Dinner",
        "metadata": null,
        "policy_caps": {
          "daily_limit_cents": 50000,
          "daily_remaining_cents": 50000,
        },
        "response": {
          "approved": true,
          "auth_status": "dev_unsigned",
          "shadow": true,
          "would_approve": true,
          "would_decline_reason": null,
        },
        "shadow_mode": true,
        "spend_snapshot": {
          "agentId": "agent_contract",
          "confirmedBalanceCents": 100000,
          "effectiveSpendPowerCents": 50000,
          "policySpendableCents": 50000,
          "reservedHoldsCents": 1500,
          "reservedOutgoingCents": 0,
          "updatedAt": 1735689610,
        },
        "timestamp": 1735689620,
        "would_approve": true,
        "would_decline_reason": null,
      },
      "ts": 1735689620,
      "type": "card_auth_shadow",
    },
    {
      "event_id": "evt_00000000-0000-0000-0000-000000000006",
      "external_ref": "A2",
      "id": "rcpt_00000000-0000-0000-0000-000000000007",
      "kind": "receipt",
      "ts": 1735689620,
      "type": "policy",
      "what_happened": "Card auth observed in shadow mode.",
      "what_happens_next": "Hold recorded; shadow decision logged.",
      "why_changed": "shadow_would_approve",
    },
    {
      "id": "evt_00000000-0000-0000-0000-000000000004",
      "kind": "event",
      "payload": {
        "agent_id": "agent_contract",
        "amount_cents": 1500,
        "auth_id": "A1",
        "auth_status": "dev_unsigned",
        "card_id": "card_contract",
        "currency": "USD",
        "facts_snapshot": {
          "buffer_cents": 0,
          "confirmed_balance_cents": 100000,
          "policy_caps": {
            "daily_limit_cents": 50000,
            "daily_remaining_cents": 50000,
          },
          "reserves": {
            "reserved_holds_cents": 0,
            "reserved_outgoing_cents": 0,
          },
        },
        "mcc": "5812",
        "merchant": "Coffee",
        "metadata": null,
        "policy_caps": {
          "daily_limit_cents": 50000,
          "daily_remaining_cents": 50000,
        },
        "response": {
          "approved": true,
          "auth_status": "dev_unsigned",
          "shadow": true,
          "would_approve": true,
          "would_decline_reason": null,
        },
        "shadow_mode": true,
        "spend_snapshot": {
          "agentId": "agent_contract",
          "confirmedBalanceCents": 100000,
          "effectiveSpendPowerCents": 50000,
          "policySpendableCents": 50000,
          "reservedHoldsCents": 0,
          "reservedOutgoingCents": 0,
          "updatedAt": 1735689600,
        },
        "timestamp": 1735689610,
        "would_approve": true,
        "would_decline_reason": null,
      },
      "ts": 1735689610,
      "type": "card_auth_shadow",
    },
    {
      "event_id": "evt_00000000-0000-0000-0000-000000000004",
      "external_ref": "A1",
      "id": "rcpt_00000000-0000-0000-0000-000000000005",
      "kind": "receipt",
      "ts": 1735689610,
      "type": "policy",
      "what_happened": "Card auth observed in shadow mode.",
      "what_happens_next": "Hold recorded; shadow decision logged.",
      "why_changed": "shadow_would_approve",
    },
    {
      "id": "evt_00000000-0000-0000-0000-000000000002",
      "kind": "event",
      "payload": {
        "agent_id": "agent_contract",
        "created_at": 1735689600,
        "created_user": false,
        "defaults": {
          "credits_cents": 50000,
          "daily_spend_cents": 50000,
          "daily_spend_used_cents": 0,
          "last_reset_at": 1735689600,
          "policy": {
            "allowlist": [
              "request_job",
              "submit_job",
              "buy_tool",
              "send_credits",
            ],
            "blocklist": [],
            "daily_limit": {
              "max_spend_cents": 50000,
            },
            "per_intent_limit": {
              "buy_tool": {
                "max_per_day": 5,
              },
              "request_job": {
                "max_per_day": 20,
              },
              "send_credits": {
                "max_per_day": 10,
              },
              "submit_job": {
                "max_per_day": 50,
              },
            },
            "step_up_threshold": {
              "spend_cents": 1000,
            },
          },
        },
        "user_id": "user_contract",
      },
      "ts": 1735689600,
      "type": "kernel.agent_created",
    },
    {
      "event_id": "evt_00000000-0000-0000-0000-000000000002",
      "external_ref": null,
      "id": "rcpt_00000000-0000-0000-0000-000000000003",
      "kind": "receipt",
      "ts": 1735689600,
      "type": "policy",
      "what_happened": "Agent created.",
      "what_happens_next": "Agent can request quotes.",
      "why_changed": "kernel.agent_created",
    },
  ],
}
`;
